\chapter{Examples of compilation to Nested Algebra}

\section{Compilation of a constant}

The constant |'a'| is compiled with rule \ref{NAC.Const}.

|NAC ('a') = | $
\begin{array}[t]{||c||}
        \colhd{\scriptstyle i} \\
        \scriptstyle{'a'} \\
        \hline
\end{array}
$

\section{Compilation of a singleton list}

The list:|'a':[]| is compiled by the use of rule \ref{NAC.Singleton.Flat} which in turn triggers rules
\ref{NAC.Wrap} and \ref{NAC.Const}.

\begin{align*}
|NAC ('a':[]) |  & = |wrap( NAC ('a')) | & \textrm{(Expand rule \ref{NAC.Singleton.Flat})}\\
                 & = \textrm{wrap}( \begin{array}[t]{||c||}
                         \colhd{\scriptstyle i} \\
                         \scriptstyle{'a'} \\
                         \hline
                 \end{array}) & \textrm{(Apply rule \ref{NAC.Const})} \\
                 & = 
\end{align*}

$
\begin{blockarray}{||c||cc||}
        \BAhline
        \begin{block}{||\BAmultirow{4pt}||cc||}
            $P$ & \BAmulticolumn{2}{c||}{L} \\
            \BAhhline{||~||--}
            \relax                    & P & I \\
            \BAhline
        \end{block}
        \begin{block}{||c||cc||}
            \BAmultirow{4pt}{1} & 1 & 10 \\
                                & 2 & 20 \\
                                & 3 & 30 \\
        \end{block}
        \BAhline
\end{blockarray}
$

